cmake_minimum_required(VERSION 3.16)
project(bcm3)

# Boost settings
set(Boost_USE_MULTITHREADED		ON)
if(CMAKE_HOST_WIN32)
    set(Boost_USE_STATIC_LIBS		ON)
    set(Boost_USE_STATIC_RUNTIME	OFF)
endif(CMAKE_HOST_WIN32)
find_package(Boost REQUIRED COMPONENTS program_options filesystem system date_time chrono)

# NetCDF settings
if(CMAKE_HOST_WIN32)
    set(NETCDF_LIBRARIES "C:/Program Files/netCDF 4.7.0/lib/netcdf.lib")
    set(NETCDF_INCLUDE_DIR "C:/Program Files/netCDF 4.7.0/include")
endif(CMAKE_HOST_WIN32)
if(CMAKE_HOST_UNIX)
    set(NETCDF_LIBRARIES "libnetcdf.so")
    set(NETCDF_INCLUDE_DIR "/usr/include")
endif(CMAKE_HOST_UNIX)

# libSBML settings
if(CMAKE_HOST_WIN32)
    set(SBML_LIBRARIES "D:/Programming/Libraries/libSBML-5.18.0-install/lib/libsbml.lib")
    set(SBML_LIBRARIES_DEBUG "D:/Programming/Libraries/libSBML-5.18.0-install/lib/libsbmld.lib")
    set(SBML_INCLUDE_DIR "D:/Programming/Libraries/libSBML-5.18.0-install/include")
endif(CMAKE_HOST_WIN32)
if(CMAKE_HOST_UNIX)
    set(SBML_LIBRARIES "libsbml.so")
    set(SBML_LIBRARIES_DEBUG "libsbml.so")
    set(SBML_INCLUDE_DIR "/usr/include")
endif(CMAKE_HOST_UNIX)

set(THREADS_PREFER_PTHREAD_FLAG ON)
find_package(Threads REQUIRED)
set(CMAKE_POSITION_INDEPENDENT_CODE ON)

# Optimization settings
if(CMAKE_HOST_WIN32)
    add_definitions(/arch:AVX)
endif(CMAKE_HOST_WIN32)
if(CMAKE_HOST_UNIX)
	set(CMAKE_BUILD_TYPE Release)
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -march=native")
endif(CMAKE_HOST_UNIX)

add_subdirectory(dependencies/cluster-1.52a/src)
add_subdirectory(dependencies/cvode-5.3.0)
add_subdirectory(dependencies/eigen-3.4-rc1)
add_subdirectory(dependencies/HungarianAlgorithm-master)
add_subdirectory(src/bcminf)
add_subdirectory(src/bcmopt)
add_subdirectory(src/bcmrbridge)
add_subdirectory(src/cellpop)
add_subdirectory(src/dynamicISA)
add_subdirectory(src/fISA)
add_subdirectory(src/likelihoods)
add_subdirectory(src/odecommon)
add_subdirectory(src/sampler)
add_subdirectory(src/sbml)
add_subdirectory(src/stats)
add_subdirectory(src/utils)